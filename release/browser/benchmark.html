<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    <h5>Click Start realtime once, gotta love chrome's new autoplay ban policy</h5>
    <button id="start">Start realtime</button>
    <script src="./csound-wasm-browser.js"></script>
    <script>
      const interval = 0.500;
    const orc = `
gilast init 0

instr 1
 icur times
 prints "delta: %fms\\n",  ((icur - gilast) - ${interval}) * 1000
 gilast = icur
 asig = poscil:a(0.05, 240)
 outc asig, asig
endin
    `
    document.getElementById('start').onclick = ()=> {
        csound.startRealtime();
        csound.compileOrc(orc);
        setInterval(() => csound.inputMessage('i 1 0 0.1'), interval * 1000);
    };
   
  </script>
</body>
</html>
