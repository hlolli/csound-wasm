<html>
  <head>
<title>csound-wasm dev</title>
</head>
<body>
  <h1>csound-wasm dev</h1>
  <script src="/libcsound.js"></script>
  <script src="/main.js"></script>
  <script>
    var csound = csound_wasm;
    const beeper = `
    <CsoundSynthesizer>
      <CsOptions>
	-+rtmidi=null -M0
      </CsOptions>
      <CsInstruments>
	;Example by Andr√©s Cabrera

	sr = 44100
	ksmps = 32
	nchnls = 2
	0dbfs = 1

        massign   0, 1 ;assign all MIDI channels to instrument 1
	
        opcode declick, a, a
	ain     xin
	aenv    linseg 0, 0.02, 1, p3 - 0.05, 1, 0.02, 0, 0.01, 0
        xout ain * aenv         ; apply envelope and write output
        endop
	
	instr 1
	iCps    cpsmidi   ;get the frequency from the key pressed
	iAmp    ampmidi   0dbfs * 0.3 ;get the amplitude
	aOut    poscil    iAmp, iCps ;generate a sine tone
	kenv	mxadsr	0.1, 0, 1, 0.5
	aOut *= kenv
        outs      aOut, aOut ;write it to the output
	endin

      </CsInstruments>
      <CsScore>
      </CsScore>
    </CsoundSynthesizer>
    `

    const makeBeep = `i 1 0 100`

    <!-- csound.startRealtime(); -->
    csound.enableMidi();
    csound.playCSD(beeper);
    <!-- csound.readScore(makeBeep); -->
  </script>
</body>
</html>
